<!DOCTYPE html>
<html lang="ha">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ciki da Raino - Kalkuletar Ovulation</title>
    <!-- Preload resources -->
    <link rel="preload" href="css/style.css" as="style">
     <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="index.css">
   
    <!-- AOS CSS -->
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <!-- Modern fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;500;700&family=Raleway:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* Error message styling */
        .error-message-container {
            display: none;
            margin: 15px 0;
            padding: 12px;
            background: #fff4f4;
            border: 1px solid #ff9aa2;
            border-radius: 8px;
            color: #e25d5d;
        }

        .error-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .error-icon {
            font-size: 1.2rem;
        }

        .error-text {
            flex: 1;
            margin: 0;
            font-size: 0.9rem;
        }

        .error-close-btn {
            background: none;
            border: none;
            color: #e25d5d;
            cursor: pointer;
            font-size: 1.2rem;
        }

        /* Loading indicator */
        .loading-container {
            display: none;
            margin: 15px 0;
            text-align: center;
        }

        .loading-content {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
        }

        .loading-spinner {
            display: flex;
            gap: 5px;
            margin-bottom: 8px;
        }

        .spinner-circle {
            width: 10px;
            height: 10px;
            background: #5e7ce2;
            border-radius: 50%;
            animation: pulse 1.5s infinite ease-in-out;
        }

        .spinner-circle:nth-child(2) {
            animation-delay: 0.3s;
        }

        .spinner-circle:nth-child(3) {
            animation-delay: 0.6s;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.4; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        .loading-text {
            color: #5e7ce2;
            font-weight: 500;
            font-size: 0.9rem;
        }

        /* Input validation styling */
        .input-error {
            border-color: #e25d5d !important;
            box-shadow: 0 0 0 2px rgba(226, 93, 93, 0.2);
        }

        .error-label {
            color: #e25d5d;
            font-size: 0.8rem;
            margin-top: 5px;
            display: block;
        }
    </style>
</head>
<body>
   <div class="main-content">
    <!-- Navigation Bar [Menu] -->
    <nav class="navbar">
        <a href="index.html" class="logo">
            <img src="logon.svg" alt="Logo"> <label for="">Ciki da Raino</label>
        </a>
        <ul class="nav-links">
            <li><a href="index.html">Shafin Gida</a></li>
            <li><a class="disabled" href="blog.html">Shirin Daukar Ciki</a></li>
            <li><a class="disabled" href="blog.html">Goyon Ciki</a></li>
            <li><a href="contact.html">Tuntuɓe Mu</a></li>
            <li><a href="about.html">Game Da Mu</a></li>
            <li><a href="hosapital.html">Asibiti Mafi Kusa</a></li>
        </ul>
        <button class="hamburger" id="hamburger" aria-label="Open menu">
            <div class="hamburger-line"></div>
            <div class="hamburger-line"></div>
            <div class="hamburger-line"></div>
        </button>
    </nav>
    
    <!-- Mobile Menu [Menu na wayar hannu] -->
    <div class="overlay" id="overlay"></div>
    <div class="mobile-menu-container" id="mobile-menu-container">
        <div class="mobile-menu-header">
            <button class="close-menu" id="close-menu" aria-label="Close menu">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="mobile-menu">
            <a href="index.html" class="drawer-menu-item">
                <i class="fas fa-home"></i>
                <span>Shafin Gida</span>
            </a>
            <a href="ovulation.html" class="drawer-menu-item">
                <i class="fas fa-venus-mars"></i>
                <span>Kalkuletar Ovulation</span>
            </a>
            <a href="tracker.html" class="drawer-menu-item">
                <i class="fas fa-baby-carriage"></i>
                <span>Bibiyar Ciki</span>
            </a>
            <a href="hospital.html" class="drawer-menu-item">
                <i class="fas fa-hospital"></i>
                <span>Asibitoci Mafi Kusa</span>
            </a>
        </div>
    </div>

    <!-- Bottom Navigation Bar -->
    <nav class="bottom-nav">
        <a href="index.html" class="bottom-nav-item">
            <i class="fas fa-home"></i>
            <span>Gida</span>
        </a>
        <a href="ovulation.html" class="bottom-nav-item">
            <i class="fas fa-venus-mars"></i>
            <span>Ovulation</span>
        </a>
        <a href="tracker.html" class="bottom-nav-item">
            <i class="fas fa-baby-carriage"></i>
            <span>Bibiyar Ciki</span>
        </a>
        <a href="hospital.html" class="bottom-nav-item">
            <i class="fas fa-hospital"></i>
            <span>Asibiti</span>
        </a>
        <a href="hospital.html" class="bottom-nav-item">
            <i class="fas fa-shopping-cart"></i>
            <span>Kasuwa</span>
        </a>
    </nav>
 
    <!-- Hero Section -->
    <section class="tracker-hero" data-aos="fade">
        <div class="container-tracker">
            <h1>Kalkuletar Ovulation</h1>
            <p>Domin binciko lokacin da mace take yin ovulation, ranaku 
                damar samun juna biyu, lokacin gwajin ciki da sauransu.</p>
        </div>
    </section>

   <!-- Calculator Section -->
<section class="calculator-section" id="calculator">
    <div class="locator-container">
        <div class="calculator-card" data-aos="fade-up">
            <h2 class="ico"><i class="fas fa-calculator"></i> Kalkuletar Ovulation</h2>
            
            <!-- Error Message Container -->
            <div id="error-message" class="error-message-container">
                <div class="error-content">
                    <i class="fas fa-exclamation-triangle error-icon"></i>
                    <p class="error-text"></p>
                    <button class="error-close-btn" aria-label="Close error message">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <!-- Loading Indicator -->
            <div id="loading-indicator" class="loading-container">
                <div class="loading-content">
                    <div class="loading-spinner">
                        <div class="spinner-circle"></div>
                        <div class="spinner-circle"></div>
                        <div class="spinner-circle"></div>
                    </div>
                    <p class="loading-text">Ana Lissafawa...</p>
                </div>
            </div>
            
            <div class="input-group">
                <label for="last-period">Shigar Da LMP Dinki:
                     <span class="tooltip" aria-label="LMP = Ranar farko da kika fara ganin jinin al'adarki na karshe. Ba wai 
                         ranar da kikai tsarki ba.">
                            <i class="fas fa-info-circle"></i>
                        </span>
                </label>
                <input type="date" id="last-period">
                <span id="last-period-error" class="error-label"></span>
            </div>
            
            <div class="input-group">
                <label for="cycle-length">Zabi Kwanakin Zagayen Al'ada:
                     <span class="tooltip" aria-label="Nan yana nufin Menstrual Cycle dinki, wato adadin kwanakin da kike dauka kafin sake ganin jini al'ada.">
                            <i class="fas fa-info-circle"></i>
                        </span>
                </label>
                <select id="cycle-length">
                    <option value="21">Kwana 21</option>
                    <option value="22">Kwana 22</option>
                    <option value="23">Kwana 23</option>
                    <option value="24">Kwana 24</option>
                    <option value="25">Kwana 25</option>
                    <option value="26">Kwana 26</option>
                    <option value="27">Kwana 27</option>
                    <option value="28" selected>Kwana 28</option>
                    <option value="29">Kwana 29</option>
                    <option value="30">Kwana 30</option>
                    <option value="31">Kwana 31</option>
                    <option value="32">Kwana 32</option>
                    <option value="33">Kwana 33</option>
                    <option value="34">Kwana 34</option>
                    <option value="35">Kwana 35</option>
                </select>
                <span id="cycle-length-error" class="error-label"></span>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" id="calculate-btn">
                    <i class="fas fa-calculator"></i> Lissafa
                </button>
                <button class="btn btn-secondary" id="reset-btn">
                    <i class="fas fa-redo"></i> Sake Lissafawa
                </button>
            </div>
        </div>
     
        <!-- Redesigned Results Container -->
        <div class="baby-tracker-container" id="results-container" style="display: none;" data-aos="fade-up">
            <div class="calendar-container">
                <h2 style="text-align: center; margin-bottom: 30px;">Sakamakon Lissafi</h2>
                <div class="calendar-header">
                    <div class="calendar-navi">
                        <button class="btn btn-secondary" id="prev-month">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <h3 id="current-month">May 2024</h3>
                        <button class="btn btn-secondary" id="next-month">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
                <table class="calendar" id="calendar">
                    <thead>
                        <tr>
                            <th>Sun</th>
                            <th>Mon</th>
                            <th>Tue</th>
                            <th>Wed</th>
                            <th>Thu</th>
                            <th>Fri</th>
                            <th>Sat</th>
                        </tr>
                    </thead>
                    <tbody id="calendar-body">
                        <!-- Calendar will be generated by JavaScript -->
                    </tbody>
                </table>
            </div>

            <div class="tracker-cards-container">
                <!-- Ovulation Day Card (Second) -->
                <div class="tracker-card progress-card">
                    <div class="card-icon">
                        <i class="fas fa-egg"></i>
                    </div>
                    <div class="card-content">
                        <h3>Ranar Ovulation
                            <span class="tooltip" aria-label="Ovulation Date">
                                 <i class="fas fa-info-circle"></i>
                            </span>
                        </h3>
                        <div class="week-display" id="ovulation-day">May 1, 2024</div>
                        <div class="health-tip-Ovul">
                          <p>Wannan ranar da ke sama, ita ce ranar Ovulation (Ma'ana ranar da 
                            kwai ke fita daga ovary zuwa bututu fallopian). 
                            Kuma wannan lokaci shi ne mafi 
                            dacewa ga 'ya mace ta samu ciki.</p>
                        </div>
                    </div>
                </div>

                <!-- Fertile Window Card (Third) -->
                <div class="tracker-card baby-dev-card">
                    <div class="card-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <div class="card-content">
                        <h3>Lokutan Daukar Ciki
                             <span class="tooltip" aria-label="Fertile Window">
                                 <i class="fas fa-info-circle"></i>
                            </span>
                        </h3>
                        
                        <div class="due-date size-comparison" id="fertile-window">May 15, 2024</div>

                        <div class="baby-milestones">
                            <div class="health-tip-fertile">Lokutan da ya fi dacewa a yawaita jima'i don 
                                samun juna biyu a cikinsu.</div>

                            <ul>
                                <li style="display: none;" class="due-date" id="fertile-window">April 27 - May 3, 2024</li>
                                <li style="display: none;">Mafi yawan haɗarin ciki: <span id="peak-fertility">May 1</span></li>
                                <li style="display: none;">Yawan haɗarin ciki: <span id="high-fertility">April 29 - May 2</span></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Next Period Card (Fourth) -->
                <div class="tracker-card due-date-card">
                    <div class="card-icon">
                        <i class="fas fa-calendar-day"></i>
                    </div>
                    <div class="card-content">
                        <h3>Haila Ta Gaba
                            <span class="tooltip" aria-label="Next Period Date">
                                 <i class="fas fa-info-circle"></i>
                            </span>
                        </h3>
                        <div class="due-date" id="next-period">May 15, 2024</div>
                        <div class="health-tip-period" id="period-countdown">14 kwanaki sun rage</div>
                    </div>
                </div>

                <!-- Pregnancy Test Card (Fifth) -->
                <div class="tracker-card health-tips-card">
                    <div class="card-icon">
                        <i class="fas fa-vial"></i>
                    </div>
                    <div class="card-content">
                        <h3>Lokacin Gwajin Ciki
                             <span class="tooltip" aria-label="Pregnancy Test">
                            <i class="fas fa-info-circle"></i>
                        </span>
                        </h3>
                        <div class="health-tip">
                            <p id="test-date-info">Mafi kyau ku jira kwana 1 bayan ranar da kuke 
                                tsammanin jinin al'ada (May 16, 2024) don mafi ingantaccen sakamako.</p>
                        </div>
                        <div class="reminder">
                            <i class="fas fa-bell"></i> Alamomin farko na shigar ciki: Sun hada da rashin zuwan al'ada, jin gajiya da kasala, ciwon nono, tashin zuciya ko kumallo dss..
                        </div>
                    </div>
                </div>
            </div>

            <!-- Visual Progress -->
            <div class="visual-progress-container" style="display:none;">
                <div class="circular-progress">
                    <svg class="progress-ring" width="120" height="120">
                        <circle class="progress-ring-circle" stroke="#A2D7D8" stroke-width="8" fill="transparent" r="52" cx="60" cy="60"/>
                        <circle class="progress-ring-circle progress-ring-fill" stroke="#FF9AA2" stroke-width="8" stroke-dasharray="326.56" stroke-dashoffset="130.624" fill="transparent" r="52" cx="60" cy="60"/>
                    </svg>
                    <div class="progress-text" id="cycle-progress-text">60%</div> 
                </div>
                <div class="pregnancy-timeline">
                    <div class="timeline-marker" style="left: 60%;">
                        <div class="marker-dot"></div>
                        <div class="marker-label">Mako 2</div>
                    </div>
                </div> 
            </div>
        </div>
    </div>
</section>

    <!-- Education Section -->
    <section class="articles" id="resources" data-aos="fade-up" style="display: none;">
        <div class="container">
            <h2 class="section-title"><i class="fas fa-book-open"></i> Albarkatun Fertility</h2>
            <p class="section-subtitle">Karanta ƙarin bayani game da ovulation da daukar ciki</p>
            <div class="articles-grid">
                <div class="article-card" data-aos="fade-up">
                    <div class="article-img" style="background-image: url('https://images.unsplash.com/photo-1498837167922-ddd27525d352?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');" aria-label="Understanding Your Cycle"></div>
                    <div class="article-content">
                        <span class="article-category">Ilimi</span>
                        <h3>Fahimtar Tsarin Al'ada</h3>
                        <p>Koyi yadda za a bi diddigin tsarin al'adarku da gano ranakunku masu yawan haihuwa.</p>
                        <a href="#" class="read-more">Karanta ƙarin <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
                
                <div class="article-card" data-aos="fade-up" data-aos-delay="100">
                    <div class="article-img" style="background-image: url('https://images.unsplash.com/photo-1530026186672-2cd00ffc50fe?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');" aria-label="Boosting Fertility Naturally"></div>
                    <div class="article-content">
                        <span class="article-category">Shawara</span>
                        <h3>Haɓaka Haihuwa Ta Halitta</h3>
                        <p>Gano canje-canjen rayuwa waɗanda zasu iya haɓaka damar ku na samun ciki.</p>
                        <a href="#" class="read-more">Karanta ƙarin <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
                
                <div class="article-card" data-aos="fade-up" data-aos-delay="200">
                    <div class="article-img" style="background-image: url('https://images.unsplash.com/photo-1505576399279-565b52d4ac71?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');" aria-label="Signs of Ovulation"></div>
                    <div class="article-content">
                        <span class="article-category">Ilimi</span>
                        <h3>Alamun Ovulation</h3>
                        <p>Gane alamun jiki waɗanda ke nuna cewa kuna cikin ovulation.</p>
                        <a href="#" class="read-more">Karanta ƙarin <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Newsletter Section -->
    <section class="newsletter" data-aos="fade-up" style="display: none;">
        <div class="container">
            <h2 class="section-title"><i class="fas fa-envelope"></i> Kasance da Sabbin Labarai</h2>
            <p class="section-subtitle">Yi rajista da jaridarmu don samun shawarwari da sabbin bayanai kan ciki a kowane mako.</p>
            <form class="newsletter-form">
                <input type="email" placeholder="Shigar da adireshin email dinka" class="newsletter-input" required aria-label="Email address">
                <button type="submit" class="newsletter-btn">Yi Rajista Yanzu</button>
            </form>
        </div>
    </section>

     <footer class="footer" style="display: none;">
        <div class="footer-content">
            <div class="footer-grid">
                <div class="footer-about">
                    <h3>Ciki da Raino</h3>
                    <p>Jarida domin lafiyar uwa da ta jariri</p>
                    <div class="social-links">
                        <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="#" aria-label="Pinterest"><i class="fab fa-pinterest"></i></a>
                    </div>
                </div>
                <div class="footer-links">
                    <h4>Hanyoyin Hanya</h4>
                    <ul>
                        <li><a href="index.html">Shafin Gida</a></li>
                        <li><a href="about.html">Game Da Mu</a></li>
                        <li><a href="blog.html">Labarai</a></li>
                        <li><a href="contact.html">Tuntuɓe Mu</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>Kayan Aiki</h4>
                    <ul>
                        <li><a href="ovulation.html">Kalkuletar Ovulation</a></li>
                        <li><a href="tracker.html">Bibiyar Ciki</a></li>
                        <li><a href="hospital.html">Asibitoci Mafi Kusa</a></li>
                    </ul>
                </div>
                <div class="footer-newsletter">
                    <h4>Kasance da Sabbin Labarai</h4>
                    <form class="footer-newsletter-form">
                        <input type="email" placeholder="Adireshin email" required aria-label="Email address">
                        <button type="submit"><i class="fas fa-paper-plane"></i></button>
                    </form>
                </div>
            </div>
            <div class="copyright">
                <p style="color: aliceblue;">&copy; <span id="year"></span> Yar'aro Creative. All rights reserved.</p>
                <div class="footer-legal">
                    <a href="#">07062121414</a>
                    <a href="#">cikidarainocommunity@gmail.com</a>
                </div>
            </div>
        </div>
    </footer>
    
   <!-- JavaScript -->
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script>
        // Initialize AOS
        AOS.init({
            duration: 800,
            offset: 100,
            once: true
        });

        // Set current year in footer
        document.getElementById('year').textContent = new Date().getFullYear();

        // Mobile Menu Toggle
        const hamburger = document.getElementById('hamburger');
        const closeMenu = document.getElementById('close-menu');
        const mobileMenuContainer = document.getElementById('mobile-menu-container');
        const overlay = document.getElementById('overlay');

        hamburger.addEventListener('click', function() {
            mobileMenuContainer.classList.add('open');
            overlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        });

        closeMenu.addEventListener('click', function() {
            mobileMenuContainer.classList.remove('open');
            overlay.classList.remove('active');
            document.body.style.overflow = '';
        });

        overlay.addEventListener('click', function() {
            mobileMenuContainer.classList.remove('open');
            overlay.classList.remove('active');
            document.body.style.overflow = '';
        });

        // Close menu when clicking on a link
        document.querySelectorAll('.mobile-menu a').forEach(link => {
            link.addEventListener('click', function() {
                mobileMenuContainer.classList.remove('open');
                overlay.classList.remove('active');
                document.body.style.overflow = '';
            });
        });

        // Close error message when button is clicked
        document.querySelector('.error-close-btn').addEventListener('click', function() {
            document.getElementById('error-message').style.display = 'none';
        });

        // Tooltip functionality
        const tooltips = document.querySelectorAll('.tooltip');
        tooltips.forEach(tooltip => {
            // For touch devices
            tooltip.addEventListener('touchstart', function(e) {
                e.preventDefault();
                tooltip.classList.add('active');
                setTimeout(() => tooltip.classList.remove('active'), 3000);
            });
            
            // For keyboard navigation
            tooltip.addEventListener('focus', function() {
                tooltip.classList.add('active');
            });
            
            tooltip.addEventListener('blur', function() {
                tooltip.classList.remove('active');
            });
        });

        // Ovulation Calculator Logic with Validation
        const calculateBtn = document.getElementById('calculate-btn');
        const resetBtn = document.getElementById('reset-btn');
        const resultsContainer = document.getElementById('results-container');
        const lastPeriodInput = document.getElementById('last-period');
        const cycleLengthSelect = document.getElementById('cycle-length');

        // Calendar Navigation Variables
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let ovulationDates = [];
        let fertileWindows = [];
        let cycleLength = 28;

        // Set default date to today
        const today = new Date();
        today.setHours(0, 0, 0, 0); // Normalize time
        const formattedDate = today.toISOString().split('T')[0];
        lastPeriodInput.value = formattedDate;

        // Validation functions
        function validateLastPeriod(date) {
            const lastPeriod = new Date(date);
            
            // Check if date is valid
            if (isNaN(lastPeriod.getTime())) {
                return {
                    isValid: false,
                    message: "Don Allah shigar da ranar haila ta ƙarshe da ta dace"
                };
            }
            
            // Check if date is in the future
            if (lastPeriod > today) {
                return {
                    isValid: false,
                    message: "Ranar haila ta ƙarshe ba za ta iya zama a nan gaba ba"
                };
            }
            
            // Check if date is too old (more than 1 year)
            const oneYearAgo = new Date();
            oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);
            if (lastPeriod < oneYearAgo) {
                return {
                    isValid: false,
                    message: "Ranar haila ta ƙarshe ba ta wuce shekara 1 ba"
                };
            }
            
            return { isValid: true };
        }

        function validateCycleLength(length) {
            const cycleLength = parseInt(length);
            
            // Check if cycle length is within reasonable range
            if (cycleLength < 21 || cycleLength > 35) {
                return {
                    isValid: false,
                    message: "Zagayen al'ada dole ya kasance tsakanin kwanaki 21 zuwa 35"
                };
            }
            
            return { isValid: true };
        }

        function showError(message) {
            const errorElement = document.getElementById('error-message');
            const errorText = errorElement.querySelector('.error-text');
            errorText.textContent = message;
            errorElement.style.display = 'block';
            
            // Auto-hide error after 5 seconds
            setTimeout(() => {
                errorElement.style.display = 'none';
            }, 5000);
        }

        function clearErrors() {
            document.getElementById('error-message').style.display = 'none';
            document.getElementById('last-period-error').textContent = '';
            document.getElementById('cycle-length-error').textContent = '';
            lastPeriodInput.classList.remove('input-error');
            cycleLengthSelect.classList.remove('input-error');
        }

        function showLoading() {
            document.getElementById('loading-indicator').style.display = 'block';
        }

        function hideLoading() {
            document.getElementById('loading-indicator').style.display = 'none';
        }

        // Calculate ovulation and fertile window
        calculateBtn.addEventListener('click', function() {
            // Clear previous errors
            clearErrors();
            
            // Validate inputs
            const lastPeriodValidation = validateLastPeriod(lastPeriodInput.value);
            if (!lastPeriodValidation.isValid) {
                showError(lastPeriodValidation.message);
                lastPeriodInput.classList.add('input-error');
                document.getElementById('last-period-error').textContent = lastPeriodValidation.message;
                return;
            }
            
            const cycleLengthValidation = validateCycleLength(cycleLengthSelect.value);
            if (!cycleLengthValidation.isValid) {
                showError(cycleLengthValidation.message);
                cycleLengthSelect.classList.add('input-error');
                document.getElementById('cycle-length-error').textContent = cycleLengthValidation.message;
                return;
            }
            
            // Show loading state
            showLoading();
            const originalBtnText = calculateBtn.innerHTML;
            calculateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ana Lissafawa...';
            calculateBtn.disabled = true;
            
            // Allow UI to update before heavy calculations
            setTimeout(() => {
                const lastPeriod = new Date(lastPeriodInput.value);
                lastPeriod.setHours(0, 0, 0, 0); // Normalize time
                
                cycleLength = parseInt(cycleLengthSelect.value);
                
                // Calculate all future ovulation dates and fertile windows (6 months ahead)
                ovulationDates = [];
                fertileWindows = [];
                
                // Calculate for current cycle
                calculateCycleDates(lastPeriod, cycleLength);
                
                // Calculate for next 6 cycles
                let nextPeriod = new Date(lastPeriod);
                for (let i = 0; i < 6; i++) {
                    nextPeriod.setDate(nextPeriod.getDate() + cycleLength);
                    calculateCycleDates(nextPeriod, cycleLength);
                }
                
                // Update results display with current cycle dates
                const currentOvulation = ovulationDates[0];
                const currentFertileWindow = fertileWindows[0];
                const nextPeriodDate = new Date(lastPeriod.getTime() + cycleLength * 86400000);
                
                document.getElementById('next-period').textContent = formatDate(nextPeriodDate);
                document.getElementById('ovulation-day').textContent = formatDate(currentOvulation.date);
                document.getElementById('fertile-window').textContent = 
                    `${formatDate(currentFertileWindow.start)} - ${formatDate(currentFertileWindow.end)}`;
                document.getElementById('peak-fertility').textContent = formatDate(currentOvulation.date);
                
                // Calculate high fertility days (3 days before ovulation)
                const highFertilityStart = new Date(currentOvulation.date);
                highFertilityStart.setDate(highFertilityStart.getDate() - 3);
                document.getElementById('high-fertility').textContent = 
                    `${formatDate(highFertilityStart)} - ${formatDate(currentOvulation.date)}`;
                
                // Update pregnancy test information
                const testDate = new Date(nextPeriodDate);
                testDate.setDate(testDate.getDate() + 2); // Day after expected period
                document.getElementById('test-date-info').textContent = 
                    ` Idan ya kasance jinin al'adarki bai zo mi ki ba, to ranar (${formatDate(testDate)}) ita ce ranar da ta fi dacewa ki yi gwajin ciki domin samun tabbacin ko kin samu ciki a watan.`;
                
                // Calculate cycle progress
                const daysPassed = Math.floor((today - lastPeriod) / (1000 * 60 * 60 * 24));
                const percentComplete = Math.min(100, Math.round((daysPassed / cycleLength) * 100));
                
                // Update progress elements
                document.getElementById('cycle-progress-text').textContent = `${percentComplete}%`;
                
                // Update countdown to next period
                const daysRemaining = cycleLength - daysPassed;
                document.getElementById('period-countdown').textContent = 
                    `Akalla kwanaki ${daysRemaining} suka rage mi ki don sake ganin wani sabon jinin al'adar daga yau.`;
                
                // Update timeline marker
                document.querySelector('.timeline-marker').style.left = `${percentComplete}%`;
                document.querySelector('.marker-label').textContent = `Mako ${Math.floor(daysPassed/7)}`;
                
                // Show results
                resultsContainer.style.display = 'block';
                
                // Generate calendar for current month
                currentMonth = today.getMonth();
                currentYear = today.getFullYear();
                generateCalendar();
                
                // Restore button state
                calculateBtn.innerHTML = originalBtnText;
                calculateBtn.disabled = false;
                hideLoading();
                
                // Smooth scroll to results
                setTimeout(() => {
                    resultsContainer.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    
                    // Add focus for better accessibility
                    resultsContainer.setAttribute('tabindex', '-1');
                    resultsContainer.focus();
                }, 100);
            }, 50);
        });

        // Calculate dates for one cycle
        function calculateCycleDates(periodStart, cycleDays) {
            const nextPeriod = new Date(periodStart);
            nextPeriod.setDate(nextPeriod.getDate() + cycleDays);
            
            // Calculate ovulation date (14 days before next period)
            const ovulationDate = new Date(nextPeriod);
            ovulationDate.setDate(ovulationDate.getDate() - 14);
            
            // Calculate fertile window (5 days before ovulation to 1 day after)
            const fertileStart = new Date(ovulationDate);
            fertileStart.setDate(fertileStart.getDate() - 5);
            
            const fertileEnd = new Date(ovulationDate);
            fertileEnd.setDate(fertileEnd.getDate() + 1);
            
            ovulationDates.push({
                date: ovulationDate,
                cycleStart: new Date(periodStart)
            });
            
            fertileWindows.push({
                start: fertileStart,
                end: fertileEnd,
                cycleStart: new Date(periodStart)
            });
        }

        // Reset calculator
        resetBtn.addEventListener('click', function() {
            lastPeriodInput.value = formattedDate;
            cycleLengthSelect.value = '28';
            resultsContainer.style.display = 'none';
            ovulationDates = [];
            fertileWindows = [];
            clearErrors();
            generateCalendar(); // Regenerate calendar without fertility markers
        });

        // Calendar Navigation
        document.getElementById('prev-month').addEventListener('click', function() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            generateCalendar();
        });

        document.getElementById('next-month').addEventListener('click', function() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            generateCalendar();
        });

        function updateCalendarHeader() {
            const monthNames = ["January", "February", "March", "April", "May", "June",
                              "July", "August", "September", "October", "November", "December"];
            document.getElementById('current-month').textContent = 
                `${monthNames[currentMonth]} ${currentYear}`;
        }

        function generateCalendar() {
            const calendarBody = document.getElementById('calendar-body');
            calendarBody.innerHTML = '';
            
            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay();
            
            let date = 1;
            
            // Create calendar rows
            for (let i = 0; i < 6; i++) {
                // Stop if we've gone through all days
                if (date > daysInMonth) break;
                
                const row = document.createElement('tr');
                
                // Create cells for each day of the week
                for (let j = 0; j < 7; j++) {
                    const cell = document.createElement('td');
                    
                    if (i === 0 && j < startingDay) {
                        // Empty cells before the first day of the month
                        cell.textContent = '';
                    } else if (date > daysInMonth) {
                        // Empty cells after the last day of the month
                        cell.textContent = '';
                    } else {
                        // Cells with dates
                        const daySpan = document.createElement('span');
                        daySpan.textContent = date;
                        cell.appendChild(daySpan);
                        
                        // Create date object for comparison
                        const currentDate = new Date(currentYear, currentMonth, date);
                        currentDate.setHours(0, 0, 0, 0);
                        
                        // Mark current day
                        if (currentDate.getTime() === today.getTime()) {
                            cell.classList.add('today');
                        }
                        
                        // Check if we have calculated fertility data
                        if (ovulationDates.length > 0) {
                            // Mark current cycle's fertile days
                            const currentFertileWindow = fertileWindows[0];
                            if (currentDate >= currentFertileWindow.start && currentDate <= currentFertileWindow.end) {
                                if (currentDate.getMonth() === currentMonth && currentDate.getFullYear() === currentYear) {
                                    // Check if this is the ovulation day
                                    const currentOvulation = ovulationDates[0];
                                    if (currentDate.getTime() === currentOvulation.date.getTime()) {
                                        cell.classList.add('ovulation-day');
                                    } else {
                                        cell.classList.add('fertile-day');
                                    }
                                }
                            }
                            
                            // Mark future cycles
                            for (let i = 1; i < ovulationDates.length; i++) {
                                const futureOvulation = ovulationDates[i];
                                const futureWindow = fertileWindows[i];
                                
                                // Mark future fertile days
                                if (currentDate >= futureWindow.start && currentDate <= futureWindow.end) {
                                    if (currentDate.getMonth() === currentMonth && currentDate.getFullYear() === currentYear) {
                                        // Check if this is the ovulation day
                                        if (currentDate.getTime() === futureOvulation.date.getTime()) {
                                            cell.classList.add('ovulation-day');
                                        } else {
                                            cell.classList.add('fertile-day');
                                        }
                                    }
                                }
                            }
                        }
                        
                        date++;
                    }
                    
                    row.appendChild(cell);
                }
                
                calendarBody.appendChild(row);
            }
            
            updateCalendarHeader();
        }

        // Format date as "dd Month, yyyy" (e.g., "16 July, 2025")
        function formatDate(date) {
            const monthNames = ["January", "February", "March", "April", "May", "June",
                              "July", "August", "September", "October", "November", "December"];
            const day = date.getDate();
            const month = monthNames[date.getMonth()];
            const year = date.getFullYear();
            return `${day} ${month}, ${year}`;
        }

        // Initialize calendar
        generateCalendar();

        // Add smooth scrolling to HTML element
        document.documentElement.style.scrollBehavior = 'smooth';
    </script>
</body>
</html>
